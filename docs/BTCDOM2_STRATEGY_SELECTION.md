# BTCDOM2 策略选择功能说明

## 概述

BTCDOM2 策略现在支持灵活的策略组合选择，用户可以根据市场情况和个人偏好选择：
- 只做多BTC
- 只做空ALT币
- 同时做多BTC和做空ALT币（原始策略）

## 功能特性

### 1. 策略选择控制

在高级设置中新增了两个复选框：

- **做多BTC** (默认选中)：控制是否持有BTC现货头寸
- **做空ALT** (默认选中)：控制是否建立ALT币做空头寸

### 2. 参数验证

- 至少需要选择一种策略（做多BTC 或 做空ALT）
- 当两个选项都未选择时，系统会显示错误提示

### 3. BTC占比的作用

BTC占比参数在不同策略组合下的含义：

- **做多BTC + 做空ALT**：BTC占比 = BTC部分 / 总资金，剩余部分用于做空ALT
- **只做多BTC**：BTC占比 = BTC部分 / 总资金，剩余部分保持现金
- **只做空ALT**：BTC占比 = 现金部分 / 总资金，剩余部分用于做空ALT

### 4. 界面调整

#### 4.1 图表显示
- **资产配置图表**：根据策略选择动态显示相应的资产类别
  - 选择做多BTC：显示BTC持仓 + 现金
  - 选择做空ALT：显示做空持仓 + 现金
  - 两者都选择：显示所有资产类别

#### 4.2 性能统计
- **策略统计**：根据策略选择调整统计指标
  - 只在选择做空ALT时显示"平均做空标的数量"
  - 策略标题显示当前选择的组合

#### 4.3 持仓表格
- **持仓过滤**：根据策略选择过滤显示的持仓
  - 只显示与选择策略相关的持仓
  - 卖出记录也按照原始持仓类型进行过滤

## 使用场景

### 场景1：看涨BTC市场
当预期BTC将大幅上涨，但ALT币表现不确定时：
- 选择：✅ 做多BTC，❌ 做空ALT
- 效果：资金全部用于BTC多头和现金，避免做空ALT的风险

### 场景2：ALT币熊市
当预期ALT币将大幅下跌，但BTC表现相对稳定时：
- 选择：❌ 做多BTC，✅ 做空ALT
- 效果：通过做空高成交量ALT币获利，避免BTC价格波动影响

### 场景3：平衡策略（默认）
当希望同时获得BTC上涨收益和ALT币下跌收益时：
- 选择：✅ 做多BTC，✅ 做空ALT
- 效果：原始BTCDOM策略，双重收益来源

## 技术实现

### 1. 前端类型定义
```typescript
export interface BTCDOM2StrategyParams {
  // ... 其他参数
  longBtc: boolean;    // 是否做多BTC (默认true)
  shortAlt: boolean;   // 是否做空ALT (默认true)
}
```

### 2. 参数验证
```typescript
if (!params.longBtc && !params.shortAlt) {
  errors.strategySelection = '至少需要选择一种策略：做多BTC或做空ALT';
}
```

### 3. 组件调整
- `BTCDOM2Chart`：接收策略参数，动态调整图表显示
- `BTCDOM2PositionTable`：根据策略选择过滤持仓显示
- 性能统计：条件显示相关指标

## 注意事项

1. **资金利用率**：单一策略可能导致部分资金闲置，但降低了策略复杂度
2. **风险控制**：可以根据市场情况灵活调整策略暴露
3. **回测对比**：可以通过不同策略组合的回测结果进行比较分析
4. **手续费影响**：单一策略的交易频率可能不同，需要关注手续费成本

## 使用示例

### 示例1：牛市策略（仅做多BTC）
**场景**：预期BTC大涨，ALT币不确定
**设置**：
- ✅ 做多BTC
- ❌ 做空ALT  
- BTC占比：80%

**效果**：80%资金做多BTC，20%现金待机

### 示例2：熊市策略（仅做空ALT）
**场景**：预期ALT币大跌，BTC横盘
**设置**：
- ❌ 做多BTC
- ✅ 做空ALT
- BTC占比：30%（现金占比）

**效果**：30%现金，70%资金做空高成交量ALT币

### 示例3：平衡策略（默认策略）
**场景**：平衡配置，双重收益
**设置**：
- ✅ 做多BTC
- ✅ 做空ALT
- BTC占比：50%

**效果**：50%做多BTC，50%做空ALT币

## 操作步骤

1. **打开高级设置**：点击参数配置区域的"高级设置"按钮
2. **选择策略组合**：在"策略选择"区域勾选想要的策略
3. **调整BTC占比**：根据策略组合调整资金分配比例
4. **执行回测**：点击"执行回测"查看不同策略组合的效果
5. **对比分析**：可以多次调整参数进行对比分析

## 性能对比建议

建议使用相同的时间周期和其他参数，仅改变策略选择，来对比不同策略组合的表现：

1. **风险收益比**：单一策略风险更集中，但操作更简单
2. **资金利用率**：组合策略资金利用率更高，但复杂度增加
3. **市场适应性**：可根据不同市场环境选择最适合的策略组合

## 后续优化建议

1. **动态策略切换**：支持在回测过程中根据市场条件动态切换策略
2. **资金再平衡**：当策略组合变化时，优化资金重新分配逻辑
3. **风险指标调整**：针对不同策略组合提供更准确的风险评估指标
4. **收益归因分析**：分别统计BTC部分和ALT做空部分的收益贡献
5. **策略评分系统**：为不同市场环境推荐最适合的策略组合